# 构建AR手势识别数据集

## 0. 前言
+ 目标：构建AR手势识别数据集。
+ 数据集数据来源：
  + 自己录制视频。
  + 从Jester中获取一些需要的数据。
  + 生成一些数据。
+ 需要实现的功能：
  + 从头文件数据集。
  + 为现有数据集添加内容。


## 1. 数据整理

### 1.1. 从需要实现的功能上分
+ 概述
  + 需要网页标注的数据。
  + 结构化视频文件夹。
  + 通过去/换背景生成的数据。
  + 通过水平镜像生成的数据
  + 背景/Nothing样本的生成。
+ 需要网页标注的数据
  + 原始视频
  + 原始视频提取帧后的帧文件夹
  + from label：通过网页标注获取
  + to label：通过from label获取，仅转换格式
  + 标注后样本对应的帧文件夹，取名为 `目标帧文件夹`：通过 from label 以及原始视频帧文件夹获取。
+ 结构化视频
  + 原始视频（所在文件夹中有若干子文件夹，子文件夹名称为类别名称，子文件夹中每个文件都是一个样本）。
  + to label：通过文件夹结构获取。
  + 目标帧文件夹：将每个视频提取帧获取帧文件夹。
+ 通过去/换背景生成的数据
  + 原始前景视频：每个视频对应一个动作。
  + 筛选后的前景视频
  + 背景视频
  + 筛选前景视频所需的结果
  + 图像生成的结果
  + to label & 目标帧文件夹：图像生成的结果本质上就是 结构化视频 。
+ 水平镜像数据
  + to label
  + 目标帧文件夹
+ 背景/nothing样本
  + 标签为Nothing的标签。


### 1.2. 文件夹结构设计
+ `label`：
  + 模型训练所需的 to label 都保存在这里。
  + 建议按照日期与来源对 to label 文件进行命名，如 `20200523_annoated.txt`。
  + 有一个文件需要将所有来源的 to label 整合到一起，命名为 `final_to_label.txt`。
  + 还需要调用 `split_dataset.py`，将 `final_to_label.txt` 分为训练样本与验证集样本，作为模型训练的输入。
+ `annotated`
  + 用于保存需要网页标注相关数据。
  + 建议每次标注都建立一个单独的文件夹，文件夹名称为当日日期。
  + 每个文件夹下保存 from label，以及标注后的`目标帧文件夹`。
  + 如果需要水平镜像，建议将对应的目标帧文件夹保存到这里。
  + PS：建议将 `原始视频` 以及 `原始视频对应帧文件夹` 保存到 `./annotation-tool/input` 中。
+ `categoried`
  + 用于保存结构化视频。
  + 建议每次标注都建立一个单独的文件夹，文件夹名称为当日日期。
  + 每个子文件夹中包含一个文件夹用于保存原始视频，以及`目标帧文件夹`。
  + 如果需要水平镜像，建议将对应的目标帧文件夹保存到这里。
+ `generated`
  + 用于保存去/换背景生成的数据。
  + 建议每次生成都建立一个独立的文件夹，文件夹名称为当日日期。
  + 每个子文件夹中包含原始fg视频、bg视频、筛选fg得到的结果、换背景得到的结果。
  + 如果需要水平镜像，建议将对应的目标帧文件夹保存到这里。
+ `background`
  + 用于保存标签为背景的样本，即nothing标签。
  + 如果需要水平镜像，建议将对应的目标帧文件夹保存到这里。


## 2. 文件夹结构
+ `raw_to_frames`
+ `videos`
+ `label`：标签文件夹。
  + 主要包括了类别标签 `category.txt` 以及构建数据集过程中生成的 `to_label.txt`。
  + `to_label.txt` 分类：
    + 初次构建数据集
      + `type1_total.txt`：自己录制/标注的样本。
      + `type2_total.txt`：Jester数据集转换为我们需要的样本形式。
      + `type3_total.txt`：将nothing视频转换为标签为nothing的样本。
      + `final_total.txt`：将上面三个文件拼接所得。
      + `flip_total.txt`：`final_total.txt` 水平镜像生成新的标签文件。
    + 为现有数据集添加样本：
      + 先通过各种方法生成一个 `to_label.txt`。
      + 在通过 `horizontal_flip_augmentation.py` 在 `flip_total.txt` 中追加数据。
    + 拆分数据集：
      + 通过 `src/split_dataset.py`，将 `flip_total.txt` 拆分为 `train_samples.txt` 和 `val_samples.txt`，用于训练。
+ `generate_videos`
+ `flip_frames`